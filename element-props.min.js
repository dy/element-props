export const parse=(e,t)=>(t=t===Object?JSON.parse:t===Array?e=>JSON.parse("["===e[0]?e:`[${e}]`):t,""===e&&t!==String||(t?t(e):!e||isNaN(+e)?e:+e)),prop=(e,t,r,o)=>(e[t=t.startsWith("on")?t.toLowerCase():t]!==r&&(!(t in e.constructor.prototype)||!(o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t))||o.set)&&(e[t]=r),!1===r||null==r?e.removeAttribute(t):"function"!=typeof r&&e.setAttribute(t,!0===r?"":"number"==typeof r||"string"==typeof r?r:"class"===t?(Array.isArray(r)?r:Object.keys(r).map((e=>r[e]?e:""))).filter(Boolean).join(" "):"style"===t&&r.constructor===Object?(t=r,r=Object.values(r),Object.keys(t).map(((e,t)=>`${e}: ${r[t]};`)).join(" ")):"")),input=e=>"INPUT"===e.tagName||"SELECT"===e.tagName?["checkbox"===e.type?()=>e.checked:()=>e.value,"text"===e.type?t=>e.value=null==t?"":t:"checkbox"===e.type?t=>(e.value=t?"on":"",prop(e,"checked",t)):"select-one"===e.type?t=>([...e.options].map((e=>e.removeAttribute("selected"))),e.value=t,e.selectedOptions[0]?.setAttribute("selected","")):t=>e.value=t]:[];export default(e,t,r)=>{const[o,s]=input(e),a=new Proxy(e.attributes,{get:(r,s)=>o&&"value"===s?o():s in e?e[s]:r[s]&&(r[s].call?r[s]:parse(r[s].value,t?.[s])),set:(o,a,p)=>(s&&"value"===a?s(p):prop(e,a,parse(p,t?.[a])),r?.(a,p,o),1),deleteProperty:(t,r,o)=>(e.removeAttribute(r),e[r]=o,delete e[r]),getOwnPropertyDescriptor:e=>({enumerable:!0,configurable:!0}),ownKeys:t=>Array.from(new Set([...Object.keys(e),...Object.getOwnPropertyNames(t)].filter((t=>e[t]!==a&&isNaN(+t)))))});return s&&s(o()),a};